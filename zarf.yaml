kind: ZarfPackageConfig
metadata:
  name: big-bang-core
  description: "Deploy Big Bang Core"
  version: 1.43.0
  url: https://p1.dso.mil/products/big-bang
  image: https://p1.dso.mil/img/Big_Bang_Color_Logo_White_text.de14c793.webp
  # Big Bang / Iron Bank are only amd64
  architecture: amd64

components:
  - name: flux
    required: true
    import:
      path: ./flux

  - name: big-bang-core
    description: "Git repositories and OCI images used by Big Bang Core"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/bigbang.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/istio-controlplane.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/istio-operator.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/jaeger.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/kiali.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/cluster-auditor.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/policy.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/monitoring.git

    images:
      # base
      - "registry1.dso.mil/ironbank/big-bang/base:2.0.0"

      # istio:
      - "registry1.dso.mil/ironbank/opensource/istio/pilot:1.14.3"
      - "registry1.dso.mil/ironbank/opensource/istio/proxyv2:1.14.3"
      - "registry1.dso.mil/ironbank/opensource/istio/install-cni:1.14.3"
      - "registry1.dso.mil/ironbank/tetrate/istio/istioctl:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/proxyv2:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/pilot:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/install-cni:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/big-bang/base:2.0.0"

      # istiooperator:
      - "registry1.dso.mil/ironbank/opensource/istio/operator:1.14.3"
      - "registry1.dso.mil/ironbank/tetrate/istio/operator:1.13.5-tetratefips-v0"

      # clusterAuditor:
      - "registry1.dso.mil/ironbank/bigbang/cluster-auditor/opa-exporter:v0.0.4"

      # policy (OPA Gatekeeper)
      - "registry1.dso.mil/ironbank/opensource/kubernetes/kubectl:v1.24.4"
      - "registry1.dso.mil/ironbank/opensource/openpolicyagent/gatekeeper:v3.9.0"

      # monitoring:
      - "registry1.dso.mil/ironbank/big-bang/grafana/grafana-plugins:9.1.3"
      - "registry1.dso.mil/ironbank/kiwigrid/k8s-sidecar:1.19.4"
      - "registry1.dso.mil/ironbank/opensource/ingress-nginx/kube-webhook-certgen:v1.3.0"
      - "registry1.dso.mil/ironbank/opensource/kubernetes/kube-state-metrics:v2.6.0"
      - "registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-config-reloader:v0.59.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-operator:v0.59.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus/alertmanager:v0.24.0"
      - "registry1.dso.mil/ironbank/opensource/prometheus/node-exporter:v1.3.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus/prometheus:v2.38.0"

  - name: logging
    description: "Git repositories and OCI images used by PLG"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/loki.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/promtail.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/tempo.git
    images:
      - "registry1.dso.mil/ironbank/opensource/grafana/loki:2.6.1"
      - "registry1.dso.mil/ironbank/opensource/grafana/promtail:v2.6.1"
      - "registry1.dso.mil/ironbank/opensource/grafana/tempo-query:1.5.0"
      - "registry1.dso.mil/ironbank/opensource/grafana/tempo:1.5.0"
