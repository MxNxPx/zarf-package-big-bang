# Big Bang v1.43.0
#
kind: ZarfPackageConfig
metadata:
  name: big-bang
  description: "Deploy Big Bang Core"
  version: 1.43.0
  url: https://p1.dso.mil/products/big-bang
  image: https://p1.dso.mil/img/Big_Bang_Color_Logo_White_text.de14c793.webp
  # Big Bang / Iron Bank are only amd64
  architecture: amd64

components:
  - name: flux
    required: true
    manifests:
      - name: flux-installer
        kustomizations:
          - https://repo1.dso.mil/platform-one/big-bang/bigbang.git/base/flux?ref=1.43.0
    images:
      - registry1.dso.mil/ironbank/fluxcd/helm-controller:v0.22.2
      - registry1.dso.mil/ironbank/fluxcd/kustomize-controller:v0.27.0
      - registry1.dso.mil/ironbank/fluxcd/notification-controller:v0.25.1
      - registry1.dso.mil/ironbank/fluxcd/source-controller:v0.26.1

  - name: big-bang
    description: "Git repositories and OCI images used by Big Bang Core"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/bigbang.git@1.43.0
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/istio-controlplane.git@1.14.3-bb.4
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/istio-operator.git@1.14.3-bb.0
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/jaeger.git@2.35.0-bb.1
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/kiali.git@1.56.1-bb.1
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/cluster-auditor.git@1.4.0-bb.10
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/policy.git@3.9.0-bb.2

    images:
      - "registry1.dso.mil/ironbank/big-bang/base:2.0.0"
      - "registry1.dso.mil/ironbank/redhat/ubi/ubi8-minimal:8.6"
      - "registry1.dso.mil/ironbank/opensource/kubernetes/kubectl:v1.24.4"
      - "registry1.dso.mil/ironbank/opensource/istio/pilot:1.14.3"
      - "registry1.dso.mil/ironbank/opensource/istio/proxyv2:1.14.3"
      - "registry1.dso.mil/ironbank/opensource/istio/install-cni:1.14.3"
      - "registry1.dso.mil/ironbank/tetrate/istio/istioctl:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/proxyv2:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/pilot:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/tetrate/istio/install-cni:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/opensource/istio/operator:1.14.3"
      - "registry1.dso.mil/ironbank/tetrate/istio/operator:1.13.5-tetratefips-v0"
      - "registry1.dso.mil/ironbank/opensource/jaegertracing/all-in-one:1.37.0"
      - "registry1.dso.mil/ironbank/opensource/jaegertracing/jaeger-operator:1.37.0"
      - "registry1.dso.mil/ironbank/opensource/kiali/kiali-operator:v1.56.1"
      - "registry1.dso.mil/ironbank/opensource/kiali/kiali:v1.56.1"
      - "registry1.dso.mil/ironbank/bigbang/cluster-auditor/opa-exporter:v0.0.4"
      - "registry1.dso.mil/ironbank/opensource/openpolicyagent/gatekeeper:v3.9.0"

  - name: minio
    description: "Git repositories and OCI images used by Minio"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/application-utilities/minio-operator.git@4.4.28-bb.1
      - https://repo1.dso.mil/platform-one/big-bang/apps/application-utilities/minio.git@4.4.28-bb.1
    images:
      - "registry1.dso.mil/ironbank/opensource/minio/operator:v4.4.28"
      - "registry1.dso.mil/ironbank/opensource/minio/console:v0.20.0"
      - "registry1.dso.mil/ironbank/opensource/minio/minio:RELEASE.2022-08-26T19-53-15Z"

  - name: keycloak
    description: "Git repositories and OCI images used by Keycloak"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/security-tools/keycloak.git@18.2.1-bb.3
    images:
      - "registry.dso.mil/platform-one/big-bang/apps/security-tools/keycloak/keycloak-ib:18.0.2-1.2.0-1"

  - name: monitoring
    description: "Git repositories and OCI images used by PLG"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/core/monitoring.git@40.0.0-bb.0
    images:
      - "registry1.dso.mil/ironbank/big-bang/grafana/grafana-plugins:9.1.3"
      - "registry1.dso.mil/ironbank/kiwigrid/k8s-sidecar:1.19.4"
      - "registry1.dso.mil/ironbank/opensource/ingress-nginx/kube-webhook-certgen:v1.3.0"
      - "registry1.dso.mil/ironbank/opensource/kubernetes/kube-state-metrics:v2.6.0"
      - "registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-config-reloader:v0.59.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus-operator/prometheus-operator:v0.59.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus/alertmanager:v0.24.0"
      - "registry1.dso.mil/ironbank/opensource/prometheus/node-exporter:v1.3.1"
      - "registry1.dso.mil/ironbank/opensource/prometheus/prometheus:v2.38.0"

  - name: log-plg
    description: "Git repositories and OCI images used by PLG"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/loki.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/promtail.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/tempo.git
    images:
      - "registry1.dso.mil/ironbank/opensource/grafana/loki:2.6.1"
      - "registry1.dso.mil/ironbank/opensource/grafana/promtail:v2.6.1"
      - "registry1.dso.mil/ironbank/opensource/grafana/tempo-query:1.5.0"
      - "registry1.dso.mil/ironbank/opensource/grafana/tempo:1.5.0"

  - name: kyverno
    description: "Git repositories and OCI images used by Kyverno Policy Engine"
    required: true
    repos:
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/kyverno.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/kyverno-policies.git
      - https://repo1.dso.mil/platform-one/big-bang/apps/sandbox/kyverno-reporter.git
    images:
      - "registry1.dso.mil/ironbank/nirmata/kyverno:v1.7.3"
      - "registry1.dso.mil/ironbank/nirmata/kyvernopre:v1.7.3"

  - name: big-bang-custom
    description: "Deploy a custom version of Big Bang Core using Keyverno and Keycloak"
      #group: big-bang-variant
    required: true
    manifests:
      - name: big-bang-config
        kustomizations:
          - "kustomizations"

